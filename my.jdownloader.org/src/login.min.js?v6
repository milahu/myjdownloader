!function(a){function b(a,b,c){return"OVERLOAD"===a.type?void b("<b>"+i18n.t("panels.errors.serverErrorHeading")+"</b><br />"+i18n.t("panels.errors.overloadError")):"TOO_MANY_REQUESTS"===a.type?void b("<b>"+i18n.t("panels.errors.serverErrorHeading")+"</b><br />"+i18n.t("panels.errors.tooManyRequestsError")):void(null!==c&&void 0!==c&&c(a))}function c(){var a={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=decodeURIComponent(d).split("#")[0]});return a}function d(b,c){var d=c.offset().top;return a("html, body").animate({scrollTop:d},null!==b&&"string"==typeof b?b:"normal"),!1}var e=null,f={Version:function(){var a=999;return-1!=navigator.appVersion.indexOf("MSIE")&&(a=parseFloat(navigator.appVersion.split("MSIE")[1])),a}},g={init:function(b){var c=!1;a("a#dropDownMenuButton").click(function(b){a("#dropDownMenu").toggle(),c=!c,c?(a("a#dropDownMenuButton img").attr("src","/images/settingsarrow32_active.png"),a("a#dropDownMenuButton").addClass("current")):(a("a#dropDownMenuButton img").attr("src","/images/settingsarrow32.png"),a("a#dropDownMenuButton").removeClass("current")),b.stopPropagation()}),a("body").click(function(b){if(c){for(var d=b.target;null!==d&&"dropDownMenu"!==d.id;)d=d.parentNode;null===d&&(a("#dropDownMenu").hide(),a("a#dropDownMenuButton img").attr("src","/images/settingsarrow32.png"),a("a#dropDownMenuButton").removeClass("current"),c=!1)}}),a("#premiumStatus").hide(),a("#freeStatus a").click(function(b){a("#freeStatus").hide(),a("#premiumStatus").show()}),this.update(b)},update:function(b){b&&b.loggedIn?(a("#currentUserMenuEntry").html("Logged in as: <b>"+b.name+"</b>"),a("#currentUserMenuEntry").show(),a("#notLoggedInMenuEntry").hide()):(a("#currentUserMenuEntry").hide(),a("#notLoggedInMenuEntry").show())},hide:function(){a("a#dropDownMenuButton").trigger("click")}},h={name:"#login",view:a("#signinPanel"),init:function(){if("#logout"==window.location.hash){"NO_TOKEN#logout"==c().reason?this.showSuccess("<b>Log out successful</b><br/>Session expired."):this.showSuccess(i18n.t("panels.general.logoutSuccessMessage"))}this.view.find(".forgotPasswordAnchor").on("click",function(){window.location="login.html#forgotPassword?email="+a("#usernameInput").val()});var d=c();d.email&&a("#usernameInput").val(d.email),a("#usernameInput").keypress(function(b){13==b.which&&a("#loginButtonFake").trigger("click")}),a("#passwordInput").keypress(function(b){13==b.which&&a("#loginButtonFake").trigger("click")}),a("#loginForm").submit(function(c){c.preventDefault(),c.stopPropagation(),h.setValidStyle();var d=a("#usernameInput").val().trim(),f=a("#passwordInput").val(),g=d.toLowerCase()!==d,i=!1,j="";if(""!==d&&/.@./.test(d)||(i=!0,a("#usernameInput").addClass("invalid"),j+=i18n.t("panels.errors.invalidEmail")),""===f&&(i=!0,a("#passwordInput").addClass("invalid"),j+=i18n.t("panels.errors.invalidPassword")),i)return void h.showError("<b>"+i18n.t("panels.errors.invalidInput")+"</b><br/>"+j);h.showError(null),a("#usernameInput").attr("disabled",!0),a("#passwordInput").attr("disabled",!0);var k=!1;e.connect({email:d,pass:f}).done(function(a){k=!0,window.location.href="index.html#dashboard"}).fail(function(c){c=JSON.parse(c.responseText),b(c,h.showError,function(b){console.log("ERROR "+b.type),"EMAIL_INVALID"===b.type?(h.showError("<b>"+i18n.t("panels.errors.emailUnknownHeader")+"</b><br />"+i18n.t("panels.errors.emailUnknown")+"<a href='login.html#register?email="+d+"'><br/>"+i18n.t("marketing.callToAction")+"</a>"),a(".noAccountAnchor").attr("href","login.html#register?email="+a("#usernameInput").val())):"AUTH_FAILED"===b.type?(h.showError("<b>"+i18n.t("panels.errors.wrongCredentialsHeader")+"</b><br/>"+i18n.t("panels.errors.wrongCredentials")+"<br/><a href='login.html#forgotPassword?email="+a("#usernameInput").val()+"'>"+i18n.t("panels.general.forgotPasswordButton")+"</a>"),g&&(window.location="login.html#forgotPassword?email="+d.toLowerCase()+"&forced=true")):"ERROR_EMAIL_NOT_CONFIRMED"===b.type&&h.showError("<b>"+i18n.t("panels.errors.emailNotConfirmedHeader")+"</b><br/>"+i18n.t("panels.errors.emailNotConfirmed")+"<br/> <a href='login.html#register?email="+a("#usernameInput").val()+"'>"+i18n.t("panels.general.requestNewInviteButton")+"</a>")}),a("#usernameInput").attr("disabled",!1),a("#passwordInput").attr("disabled",!1)})})},clear:function(){console.log("CLEAR LOGIN DATA"),a("#usernameInput").val(""),a("#passwordInput").val(""),a("#signinPanel .errorMessage").hide(),a(".noAccountAnchor").attr("href","login.html#register"),h.setValidStyle()},setValidStyle:function(){a(".invalid").removeClass("invalid")},showError:function(b){if(null===b)return void a("#signinPanel .errorMessage").hide();a("#signinPanel .errorMessage").html(b),a("#signinPanel .errorMessage").show()},showSuccess:function(b){a("#signinPanel .successMessage").html(b),a("#signinPanel .successMessage").show()}},i={name:"register",view:a("#registerPanel"),init:function(){this.captcha||(this.captcha=new jd.Captcha("#registerPanel",e)),this.reloadCaptcha(),this.view.fadeIn(1e3),this.view.removeAttr("style");var d=c();d.email&&a("#registerEmailInput").val(d.email);var f=this;a("#registerEmailInput").keyup(function(){if(/.*@(outlook|hotmail|live|msn|microsoft)\..*/g.test(a("#registerEmailInput").val())){var b="<b>"+i18n.t("panels.errors.hotmailErrorHeader")+"</b><br/>"+i18n.t("panels.errors.hotmailErrorBody")+"<br/>";a("#registerEmailInput").addClass("invalid"),i.showError(b,!0),a("#registerButton").prop("disabled",!0),a("#registerButton").prop("class","xbuttonDisabled")}else i.showError(null),a("#registerEmailInput").removeClass("invalid"),a("#registerButton").prop("disabled",!1),a("#registerButton").prop("class","xbutton")}),a("#registerForm").submit(function(c){c.preventDefault(),i.setValidStyle();var d=a("#registerEmailInput").val().trim(),g=i.captcha.getChallenge(),h=i.captcha.getResponse(),j=a("#termsCheckbox").is(":checked"),k=!0,l=!1,m="<b>"+i18n.t("panels.errors.invalidInput")+"</b><br/>";if(j||(m=m+i18n.t("panels.errors.termsNotAccepted")+"<br/>",a("#termsCheckbox").addClass("invalid"),k=!1),""!==d&&i.validateEmail(d)||(m=m+i18n.t("panels.errors.invalidEmail")+"<br/>",a("#registerEmailInput").addClass("invalid"),k=!1),/.*@(outlook|hotmail|live|msn)\..*/g.test(d)&&(m=m+i18n.t("panels.errors.invalidEmailHotmail")+"<br/>",a("#registerEmailInput").addClass("invalid"),k=!1),""===h&&(m=m+i18n.t("panels.errors.emptyCaptcha")+"<br/>",a("#registerPanel .captchaResponseInput").addClass("invalid"),k=!1),!k)return void i.showError(m,!0);i.showError(null);var n=e.registerUser({email:d,captchaChallenge:g,captchaResponse:h});n.isHotmail=l,a("#registerEmailInput").attr("disabled",!0),a("#captchaResponseInput").attr("disabled",!0),a("#termsCheckbox").attr("disabled",!0),n.done(function(b){a("#registerEmailInput").attr("disabled",!1),a("#termsChekcbox").attr("disabled",!1),a("#captchaResponseInput").attr("disabled",!1),n.isHotmail?window.location.hash="sentInviteHotmail":window.location.hash="sentInvite"}),n.fail(function(c){console.log("REG FAILED"),b(JSON.parse(c.responseText),i.showError,function(b){return"EMAIL_FORBIDDEN"==b.type?(i.showError("<b>"+i18n.t("panels.errors.invalidEmail")+"</b><br/>"+i18n.t("panels.errors.emailAlreadyRegistered")+"<br/><a href='login.html#forgotPassword?email="+a("#usernameInput").val()+"'>"+i18n.t("panels.general.forgotPasswordButton")+"</a>"),a("#registerEmailInput").addClass("invalid"),void a(".backToLoginAnchor").attr("href","login.html?email="+a("#registerEmailInput").val())):"CHALLENGE_FAILED"==b.type?(i.showError("<b>"+i18n.t("panels.errors.captchaError")+"</b><br/>"+i18n.t("panels.errors.wrongCaptcha")),a("#captchaResponseInput").addClass("invalid"),void f.captcha.reload()):"EMAIL_INVALID"==b.type?(i.showError("<b>"+i18n.t("panels.errors.invalidEmail")+"</b><br/>"+i18n.t("panels.errors.invalidEmail")),void a("#registerEmailInput").addClass("invalid")):void i.showError("<b>Input Error</b><br/>"+i18n.t("panels.errors.unknownError"))})})})},captcha:null,reloadCaptcha:function(){this.captcha&&this.captcha.reload()},validateEmail:function(a){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(a)},showError:function(b,c){if(null===b)return void a("#registerPanel .errorMessage").hide();a("#registerPasswordInput").attr("disabled",!1),a("#registerPasswordConfirmInput").attr("disabled",!1),a("#registerEmailInput").attr("disabled",!1),a("#termsChekcbox").attr("disabled",!1),a("#captchaResponseInput").attr("disabled",!1),c||this.reloadCaptcha(),a("#registerPanel .errorMessage").html(b),a("#registerPanel .errorMessage").show()},showSuccess:function(b){if(console.log("Show success message: "+b),null===b)return void a("#registerPanel .successMessage").hide();a("#registerPanel .successMessage").html(b),a("#registerPanel .successMessage").show()},clear:function(){a("#registerEmailInput").val(""),a("#registerPasswordInput").val(""),a("#registerPasswordConfirmInput").val("");a("#termsChekcbox").prop("checked",!1);this.reloadCaptcha(),a("#registerPanel .errorMessage").hide(),a(".backToLoginAnchor").attr("href","login.html")},setValidStyle:function(){a(".invalid").removeClass("invalid")}},j={name:"purchase",view:a("#purchasePanel"),init:function(){this.captcha=new jd.Captcha("#purchasePanel",e),this.reloadCaptcha(),a("#invoiceInputs").hide()},reloadCaptcha:function(){this.captcha&&this.captcha.reload()}},k={name:"validate",view:a("#validatePanel"),init:function(){var d=c().email.trim(),f=c().key;this.showError(null),a("#emailValidationKeyInput").val(f),a("#emailValidationInput").val(d),d&&""!==d||a("#emailValidationInput").show(),f&&""!==f||a("#emailValidationKeyInput").show(),a("#validationForm").submit(function(c){c.preventDefault(),a(".invalid").removeClass("invalid");var d=a("#emailConfirmPasswordInput").val(),f=a("#emailValidationInput").val(),g=a("#emailValidationKeyInput").val(),h=!0,i="<b>"+i18n.t("panels.errors.invalidInput")+"</b><br/>";if(""!==f&&/.@./.test(f)||(i=i+i18n.t("panels.errors.invalidEmail")+"<br/>",a("#emailValidationInput").addClass("invalid"),h=!1),""===g&&(i=i+i18n.t("panels.errors.emptyKey")+"<br/>",a("#registerPasswordInput").addClass("invalid"),h=!1),""===d&&(i=i+i18n.t("panels.errors.emptyPassword")+"<br/>",a("#emailConfirmPasswordInput").addClass("invalid"),h=!1),!h)return void k.showError(i);e.confirmEmail(f,g,d).done(function(a){console.log("validated"),e.connect({email:f,pass:d}).done(function(){window.location="index.html#dashboard"})}).fail(function(c){k.showSuccess(null),a("#validationWelcome").show();var d=JSON.parse(c.responseText);console.log(d),b(d,k.showError,function(b){return"AUTH_FAILED"==b.type?(k.showError("<b>"+i18n.t("panels.errors.invalidInput")+"</b><br/>"+i18n.t("panels.errors.possibleReason")+"<br/>"+i18n.t("panels.errors.invalidEmail")+"<br/>"+i18n.t("panels.errors.expiredKey")+"<br/><a href='login.html#register'>"+i18n.t("panels.errors.requestNewInviteButton")+"</a>"),a("#emailConfirmPasswordInput").addClass("invalid"),a("#emailValidationInput").addClass("invalid"),void a("#emailConfirmConfirmationPasswordInput").addClass("invalid")):"EMAIL_INVALID"==b.type?(k.showError("<b>"+i18n.t("panels.errors.emailUnknownHeader")+"</b><br/>"+i18n.t("panels.errors.emailUnknown")+"<br/><a href='login.html#register?email="+f+"'>"+i18n.t("panels.errors.requestNewInviteButton")+"</a>"),a("#emailConfirmPasswordInput").addClass("invalid"),a("#emailValidationInput").addClass("invalid"),void a("#emailConfirmConfirmationPasswordInput").addClass("invalid")):"ERROR_EMAIL_NOT_CONFIRMED"==b.type?(k.showError("<b>"+i18n.t("panels.errors.emailExpiredHeader")+"</b><br/>"+i18n.t("panels.errors.emailExpired")+"<br/><a href='login.html#register?email="+f+"'>"+i18n.t("panels.errors.requestNewInviteButton")+"</a></b>."),a("#emailConfirmPasswordInput").addClass("invalid"),a("#emailValidationInput").addClass("invalid"),void a("#emailConfirmConfirmationPasswordInput").addClass("invalid")):"FAILED"==b.type?(k.showError("<b>"+i18n.t("panels.errors.expiredKey")+"</b><br/>"+i18n.t("panels.errors.emailExpiredHeader")+"<br/><a id='requestNewValidationKey'>"+i18n.t("panels.errors.requestNewInviteButton")+"</a>"),a("#emailValidationKeyInput").addClass("invalid"),a("#requestNewValidationKey").off("click"),void a("#requestNewValidationKey").on("click",function(){var b=a("#emailConfirmPasswordInput").val();e.requestConfirmEmail(b).done(function(a){k.showError(null),k.showSuccess("New validation key sent.")}).fail(function(a){k.showSuccess(null),k.showError("Error requesting new validation key. Check your email and password input and try the confirmation again.")})})):void k.showError(i18n.t("panels.errors.unknownError"))})})})},clear:function(){a("#emailConfirmPasswordInput").val(""),a("#emailConfirmConfirmationPasswordInput").val(""),a("#emailValidationInput").val(""),a("#emailValidationKeyInput").val("");var b=c().email,d=c().key;b&&""!==b&&(a("#emailValidationInput").hide(),a("#validationWelcome").html(i18n.t("panels.validateEmail.welcome")+"<b>"+b+"</b><br/>"+i18n.t("panels.validateEmail.callToAction")),a("#validationWelcome").show()),d||""!==d?a("#emailValidationKeyInput").hide():(a("#validationWelcome").html(i18n.t("panels.validateEmail.welcome")+b+"</b><br/>"+i18n.t("panels.validateEmail.callToActionWithKey")),a("#validationWelcome").show())},showSuccess:function(b){if(null===b)return void a("#validatePanel .successMessage").hide();a("#validatePanel .successMessage").html(b),a("#validatePanel .successMessage").show()},showError:function(b){if(void 0===b||null===b)return void a("#validatePanel .errorMessage").hide();a("#validatePanel .errorMessage").html(b),a("#validatePanel .errorMessage").show()}},l={name:"resetpassword",selector:this.name+"Panel",view:a("#changepasswordPanel"),viewelements:{form:a("#changepasswordPanel .form"),keyInput:a("#changePasswordKeyInput"),emailInput:a("#changePasswordEmailInput"),oldPassInput:a("#changePasswordOldPassInput"),newPassInput:a("#changePasswordNewPassInput"),newPassConfirmInput:a("#changePasswordNewPassConfirmInput"),confirmButton:a("#changePasswordConfirmButton"),errorMessage:a("#changepasswordPanel .errorMessage"),successMessage:a("#changepasswordPanel .successMessage")},model:{key:"",email:"",oldPass:"",newPass:"",populate:function(){var b=!0,c="<b>"+i18n.t("panels.errors.invalidInput")+"</b>";return""!==this.viewelements.keyInput.val()?this.model.key=this.viewelements.keyInput.val():(b=!1,c=c+"<br/>"+i18n.t("panels.errors.emptyKey"),this.viewelements.keyInput.addClass("invalid")),""!==this.viewelements.emailInput.val()?this.model.email=this.viewelements.emailInput.val():(b=!1,c=c+"<br/>"+i18n.t("panels.errors.invalidEmail"),this.viewelements.emailInput.addClass("invalid")),""!==this.viewelements.newPassInput.val()?this.model.newPass=this.viewelements.newPassInput.val():(b=!1,c=c+"<br/>"+i18n.t("panels.errors.invalidPassword"),this.viewelements.newPassInput.addClass("invalid")),a.extend(this.model,{validated:b,errorMessageHTML:c})}},actions:{submit:function(a){a.preventDefault();var c=this.model.populate.call(this);if(c.validated){var d=e.changePassword(c.email,c.newPass,c.key);d.done(function(){e.connect({email:c.email,pass:c.newPass}).done(function(){console.log("Login with new pw successful!"),window.location="index.html#dashboard"})}),d.fail(function(a){var c=JSON.parse(a.responseText),d="<b>"+i18n.t("panels.errors.wrongCredentialsHeader")+"</b></br>";b(c,l.actions.showError,function(a){return"AUTH_FAILED"==a.type?(d=d+i18n.t("panels.errors.possibleReason")+"<br/>"+i18n.t("panels.errors.invalidInput")+"<br/>"+i18n.t("panels.errors.invalidKey"),void l.actions.showError(d)):"ERROR_EMAIL_NOT_CONFIRMED"==a.type?(d=d+i18n.t("panels.errors.emailNotConfirmedHeader")+". <a href='login.html#register'>"+i18n.t("panels.general.requestNewInviteButton")+"</a>",void l.actions.showError(d)):void 0})})}else this.actions.showError.call(this,c.errorMessageHTML)},showError:function(a){if(!a||null===a)return void l.viewelements.errorMessage.hide();l.viewelements.errorMessage.html(a),l.viewelements.errorMessage.show()},showSuccess:function(a){if(!a||null===a)return void l.viewelements.successMessage.hide();l.viewelements.successMessage.html(a),l.viewelements.successMessage.show()}},init:function(){this.viewelements.form.on("submit",this.actions.submit.bind(this));var b=c(),d=b.key,e=b.email;d&&this.viewelements.keyInput.val(b.key),e&&this.viewelements.emailInput.val(b.email),(e||""===e)&&(a("#changePasswordEmailInput").hide(),a("#changePasswordWelcome").html(i18n.t("panels.changePassword.welcome")+" <b>"+e+"</b><br/>"+i18n.t("panels.changePassword.callToActionWithKey")),a("#changePasswordWelcome").show()),d||""===d?a("#changePasswordKeyInput").hide():(a("#changePasswordWelcome").html(i18n.t("panels.changePassword.welcome")+" <b>"+e+"</b><br/>"+i18n.t("panels.changePassword.callToAction")),a("#changePasswordWelcome").show())},clear:function(){this.viewelements.keyInput.val(""),this.viewelements.emailInput.val(""),this.viewelements.newPassInput.val(""),this.viewelements.newPassConfirmInput.val(""),this.actions.showSuccess(null),this.actions.showError(null),a(".invalid").removeClass("invalid")}},m={name:"forgotPassword",view:a("#forgotPasswordPanel"),checkIfHotmail:function(){if(/.*@(outlook|hotmail|live|msn|microsoft)\..*/g.test(a("#forgotPasswordEmailInput").val())){var b="<b>"+i18n.t("panels.errors.hotmailErrorHeader")+"</b><br/>"+i18n.t("panels.errors.hotmailErrorForgotPasswordBody")+"<br/>";a("#forgotPasswordEmailInput").addClass("invalid"),m.showError(b,!0),a("#forgotPasswordSubmitButton").prop("disabled",!0),a("#forgotPasswordSubmitButton").prop("class","xbuttonDisabled")}else m.showError(null),a("#forgotPasswordEmailInput").removeClass("invalid"),a("#forgotPasswordSubmitButton").prop("disabled",!1),a("#forgotPasswordSubmitButton").prop("class","xbutton")},init:function(){this.api=e,this.captcha||(this.captcha=new jd.Captcha("#forgotPasswordPanel",this.api)),this.captcha.reload(),this.view.find(".successMessage").show().html(i18n.t("panels.forgotPassword.notice")),this.view.find(" .emailInput").val(c().email),m.checkIfHotmail(),a("#forgotPasswordEmailInput").keyup(function(){m.checkIfHotmail()});var d=this,f=(l.actions.showSuccess,function(c){c.preventDefault(),a(".invalid").removeClass("invalid");var e=d.view.find(" .emailInput").val().trim(),f=d.captcha.getResponse(),g="<b>"+i18n.t("panels.errors.invalidInput")+"</b></br>",h=!0;if(""===e&&(g=g+i18n.t("panels.errors.invalidEmail")+"<br/>",d.view.find(" .emailInput").addClass("invalid"),h=!1),""===f&&(g=g+i18n.t("panels.errors.emptyCaptcha")+"<br/>",d.view.find(" .captchaResponseInput").addClass("invalid"),h=!1),!h)return void d.showError(g);var i=d.api.requestPasswordChangeEmail(e,d.captcha.getChallenge(),d.captcha.getResponse());i.done(function(){window.location.hash="sentPwRequest"}),i.fail(function(a){d.captcha.reload(),console.log(a);var c=JSON.parse(a.responseText);b(c,d.showError,function(){return"CHALLENGE_FAILED"==c.type?void d.showError("<b>"+i18n.t("panels.errors.captchaError")+"</b><br />"+i18n.t("panels.errors.wrongCaptcha")):"EMAIL_INVALID"==c.type?void d.showError("<b>"+i18n.t("panels.errors.emailUnknownHeader")+"</b><br />"+i18n.t("panels.errors.emailUnknown")+"<a href='login.html#register?email="+e+"'>"+i18n.t("panels.general.requestNewInviteButton")+"</a>"):"ERROR_EMAIL_NOT_CONFIRMED"==c.type?void d.showError("<b>"+i18n.t("panels.errors.emailNotConfirmedHeader")+"</b><br />"+i18n.t("panels.errors.emailNotConfirmed")):void 0})})});this.view.find(" .form").on("submit",f)},clear:function(){this.captcha&&this.captcha.reload(),this.showError(null),this.showSuccess(null),this.view.find(" .emailInput").val(""),a(".invalid").removeClass("invalid")},showError:function(a){if(void 0===a||null===a)return void this.view.find(" .errorMessage").hide();this.view.find(" .errorMessage").show().html(a)},showSuccess:function(a){if(void 0===a||null===a)return void this.view.find(" .successMessage").hide()},captcha:null},n={name:"cancel",view:a("#cancelPanel"),init:function(){var b=c().email.trim(),d=c().key;a("#cancelFormText").html("<b>"+i18n.t("panels.cancelInvite.welcome")+" "+b+"</b></br>"+i18n.t("panels.cancelInvite.callToAction"));var e=this;a("#cancelForm").submit(function(c){c.preventDefault(),e.clear(),jd.AppController.showLoadingGif();var f=!0,g="<b>"+i18n.t("panels.errors.invalidInput")+"</b><br/>";if(""!==b&&/.@./.test(b)||(g=g+i18n.t("panels.errors.invalidEmail")+"<br/>",a("#emailCancelInput").addClass("invalid"),f=!1),""===d&&(g=g+i18n.t("panels.errors.emptyKey")+"<br/>",a("#emailCancelKeyInput").addClass("invalid"),f=!1),!f)return void e.showError(g);var h=a.ajax({type:"POST",url:"http://api.jdownloader.org/my/cancelregistrationemail",data:{email:b,key:d}});return h.done(function(b){e.showSuccess("<b>"+i18n.t("panels.cancelInvite.successMessageHeader")+"</b><br/>"+i18n.t("panels.cancelInvite.successMessage")+' <a href="login.html#register">'+i18n.t("panels.general.requestNewInviteButton")+"</a>"),a("#cancelInviteButton").hide()}),h.fail(function(a){var b=JSON.parse(a.responseText);"EMAIL_INVALID"===b.type?e.showError("<b>"+i18n.t("panels.errors.invalidEmail")+"</b><br/>"+i18n.t("panels.cancelInvite.invalidEmailMessage")):"FAILED"===b.type?e.showError("<b>"+i18n.t("panels.cancelInvite.cancelRequestInvalidHeader")+"</b><br/>"+i18n.t("panels.cancelInvite.cancelRequestInvalid")+"<br/> <a href='login.html#register'>"+i18n.t("panels.general.requestNewInviteButton")+"</a>"):e.showError(b.type)}),!1})},showError:function(a){if(void 0===a||null===a)return void this.view.find(" .errorMessage").hide();this.view.find(" .errorMessage").show().html(a)},showSuccess:function(a){if(void 0===a||null===a)return void this.view.find(" .successMessage").hide();this.view.find(" .successMessage").show().html(a)},clear:function(){this.showError(null),this.showSuccess(null),a(".invalid").removeClass("invalid")}},o={name:"delete",view:a("#requestTerminationPanel"),init:function(){this.captcha||(this.captcha=new jd.Captcha("#requestTerminationPanel",e)),this.captcha.reload(),this.view.find(".successMessage").show().html("Enter password and captcha to finish account deletion"),this.view.find(" .emailInput").val(c().email),c().forced&&this.view.find(".successMessage").show().html(i18n.t("panels.finishTermination.welcomeMessage"));var d=this,f=(l.actions.showSuccess,function(f){f.preventDefault(),a(".invalid").removeClass("invalid");var g=d.view.find(" .emailInput").val().trim(),h=d.view.find(" .passwordInput").val(),i=d.captcha.getResponse(),j="<b>"+i18n.t("panels.errors.invalidEmail")+"</b></br>",k=!0;if(""===g&&(j=j+i18n.t("panels.errors.emptyEmail")+"<br/>",d.view.find(" .emailInput").addClass("invalid"),k=!1),""===i&&(j=j+i18n.t("panels.errors.emptyCaptcha")+"<br/>",d.view.find(" .captchaResponseInput").addClass("invalid"),k=!1),!k)return void d.showError(j);var l=c().key,m=e.finishTermination(g,h,l,d.captcha.getChallenge(),d.captcha.getResponse());m.done(function(){localStorage.removeItem("jdapi/src/core/core.js"),window.location.search=""}),m.fail(function(a){d.captcha.reload(),console.log(a);var c="<b>"+i18n.t("panels.errors.invalidInput")+"</b><br />",e=JSON.parse(a.responseText);b(e,d.showError,function(){return"CHALLENGE_FAILED"===e.type?void d.showError(c+i18n.t("panels.errors.wrongCaptcha")):"EMAIL_INVALID"===e.type?void d.showError("<b>"+i18n.t("panels.errors.invalidEmail")+"</b><br />"+i18n.t("panels.errors.emailUnknown")+" <a href='login.html#register?email="+g+"'>"+i18n.t("panels.general.requestNewInviteButton")+"</a>"):"ERROR_EMAIL_NOT_CONFIRMED"===e.type?void d.showError(c+i18n.t("panels.errors.emailNotConfirmedHeader")):"AUTH_FAILED"===e.type?void d.showError(c+"Check your password."):"FAILED"===e.type?void d.showError(c+"Deletion failed, check your inputs."):void 0})})});this.view.find(" .form").on("submit",f)},clear:function(){this.captcha&&this.captcha.reload(),this.showError(null),this.showSuccess(null),this.view.find(" .emailInput").val(""),a(".invalid").removeClass("invalid")},showError:function(a){if(void 0===a||null===a)return void this.view.find(".errorMessage").hide();this.view.find(".errorMessage").show().html(a)},showSuccess:function(a){if(void 0===a||null===a)return void this.view.find(" .successMessage").hide()},captcha:null},p={name:"sentInvite",view:a("#registerSuccess"),init:function(){}},q={name:"sentInviteHotmail",view:a("#registerSuccessHotmail"),init:function(){}},r={name:"sentPwRequest",view:a("#changePwRequestSuccess"),init:function(){}},s={name:"signedIn",view:a("#alreadySignedInPanel"),init:function(){console.log(e.getCurrentUser()),a("#logoutNotice").html(i18n.t("panels.alreadySignedIn.welcomeMessage",{username:e.getCurrentUser().name})+"<br/><a href='login.html#logout'>Logout</a>")}},t=(a("#oldBrowserPanel"),{startUp:function(b,d){var g=c().locale,t={fallbackLng:"en",debug:!0};g&&(console.log(g),t.lng=g),i18n.init(t,function(g){a("body").i18n(),e=b;var t=jd.AppController(e);t.registerPanel(k),t.registerPanel(h),t.registerPanel(i),t.registerPanel(l),t.registerPanel(m),t.registerPanel(s),t.registerPanel(n),t.registerPanel(r),t.registerPanel(p),t.registerPanel(q),t.registerPanel(j),t.registerPanel(o),t.setDefaultHistoryToken("#login"),console.log("#Panels registered"),t.printRegisteredPanels(),a(window).on("hashchange",function(){var a,b=c();a=b.action?b.action:/^[^\\?]+(?=\\?)/.exec(window.location.hash),console.log("History Token changed: "+a),t.onHistoryTokenChange(a)}),f.Version()<10&&(window.location.hash="oldBrowser"),d&&a.isFunction(d)&&d()})},clear:function(){this.registerPanel.clear(),this.loginPanel.clear()}});scrollToTop=function(b){return d(b,a("#mainnav"))},scrollToFeatures=function(b){return d(b,a("#features"))},window.jd=window.jd||{},window.jd.MyJDLandingPage=t,window.jd.JDGearMenu=g}(jQuery),function(a){"use strict";var b=function(b){if(this.api=b,!c)var c=[];var d="#login",e="#signedIn",f=function(h){h=h||"",h=h.toString(),"#logout"!=h&&"#maintenance"!=h||b.disconnect().always(function(){window.jd.JDGearMenu&&window.jd.JDGearMenu.update(b.getCurrentUser()),f("#login")}),-1===h.indexOf("delete")&&-1===h.indexOf("forgotPassword")&&-1===h.indexOf("resetpassword")&&-1===h.indexOf("sentPwRequest")&&3!==b.getAPIState()&&(console.log("Switch to signedIn panel"),console.log(b.getAPIState()),h=e),c.push(["_trackPageview","login.html"+h]);for(var i=0;i<g.length;i++)if(g[i].name==h||"#"+g[i].name==h)return a(".visible").removeClass("visible"),g[i].clear&&g[i].clear(),g[i].init(),void g[i].view.addClass("visible");if(console.warn("HISTORY TOKEN INVALID "+h),h===d)throw"Missing defaultHistoryToken Panel";if(h===e)throw"Missing signedInHistoryToken Panel";null===d&&void 0===d||h==d||f(d)},g=[];return{setDefaultHistoryToken:function(a){a=a},registerPanel:function(a){void 0!==a&&null!==a&&(g[g.length]=a)},printRegisteredPanels:function(){for(var a=0;a<g.length;a++)console.log(g[a].name)},onHistoryTokenChange:function(a){f(a)},showLoadingGif:function(){a("#loadingGif").show()},hideLoadingGif:function(){a("#loadingGif").hide()}}},c=function(b,c){this.contextId=b,this.jdapi=c,a(b+" .captchaReloadButton").click(this.reload.bind(this))};a.extend(c.prototype,{reload:function(){var b=this.jdapi.getCaptcha();return b.done(function(b){a(this.contextId+" .captchaImage").attr("src",b.image),this.challenge=b.captchaChallenge,a(this.contextId+" .captchaResponseInput").val("")}.bind(this)),b.fail(function(a){console.warn(JSON.parse(a.responseText))}),b},getChallenge:function(){return this.challenge},getResponse:function(){return a(this.contextId+" .captchaResponseInput").val()}});var d=function(){};a.extend(d.prototype,{newItem:function(a,b){b=b||{};var c="";c=window.location.toString().split("#")[0],c=c+"#"+a,window.location="#"+a},setParam:function(a,b){var c=window.location.toString(),d=null;if(-1!==c.indexOf("#")){var e=c.split("#");e[1]&&(d=e[1])}var f="?"+a+"="+b;d&&(f=f+"#"+d),window.location=f},getParam:function(a){var b=window.location.search;if(""===b)return"";b=b.substring(1,b.length);var c=b.split("&"),d="";return c.forEach(function(b){var c=b.split("=");if(a===c[0])return d=c[1],!1}),d}}),window.jd=window.jd||{},window.jd.AppController=b,window.jd.Historian=new d,window.jd.Captcha=c}(jQuery);
//# sourceMappingURL=sourcemap.map